<?xml version="1.0" encoding="UTF-8"?>
<mm:content xmlns:mm="http://nokia.com/mmenu" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="http://nokia.com/mmenu ../mmenuschema.xsd" genre="tvvideosuite">

    <mm:localization namespace="tvvideosuite_loc" source="videosuiteres.rsc"/>
    
     <!-- last watched item definition -->               
    <mm:item count="1" template="logical_template_6a" id="tvvideolastwatched">                                     
        <mm:query namespace="tvvideoquery" service="Service.ContentPublishing" interface="IDataSource">
            <mm:command mode="sync" name="GetList">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="lastwatchedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:query>
        <mm:notify_request service="Service.ContentPublishing" interface="IDataSource">
            <mm:command name="RequestNotification">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="lastwatchedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                  </mm:key>
            </mm:command>
        </mm:notify_request>
                                               
        <mm:output alias="mul_title" type="string" value="tvvideosuite_loc:R_VCXNS_MMENU_LAST_WATCHED_TITLE"/>     
        <!-- show last watched name only if some data has published -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideolastwtype &gt; 0"> 
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_LAST_WATCHED_NAME">
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideonamevalue"/>
            </mm:text> 
        </mm:output> 
        
        <mm:output alias="mul_icon" condition="tvvideoquery:results/[$index]/data_map/tvvideoiconpath &gt; 0">
            <mm:image file="tvvideoquery:results/[$index]/data_map/tvvideoiconpath"/> 
        </mm:output> 
        <mm:output alias="mul_icon" condition="tvvideoquery:results/[$index]/data_map/tvvideoiconpath = ">
            <!-- Default last watched icon is qgn_prop_file_video.
            AknsConstants.h defines KAknsIIDQgnPropFileVideo skin-ids.
            And videosuite.mbg defines EMbmVideosuiteQgn_prop_file_video = 16384,
                                       EMbmVideosuiteQgn_prop_file_video_mask = 16385 -->
            <mm:image skinid_major="0x100056c6" skinid_minor="0x1080" bitmap_id="16384" mask_id="16385" mif_file="videosuite.mif"/>
        </mm:output> 
        
        <mm:event event="key:select"> 
            <!-- 3 == iptvcontent -->
            <mm:action service="Service.ActionHandler" interface="IDataAction" condition="tvvideoquery:results/[$index]/data_map/tvvideolastwtype=3" >
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>                        
                        <mm:key name="data">
                            <mm:key name="message" type="string" value="EIPTVMessageLastWatched"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action> 
            <!-- 1 == lastwatched content, meaning all other than iptv -->
            <mm:action service="Service.ActionHandler" interface="IDataAction" condition="tvvideoquery:results/[$index]/data_map/tvvideolastwtype=1">
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>                
                        <mm:key name="data">
                            <mm:key name="message" type="string" value="ELaunchVideoToPlayer"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action>
        </mm:event>      
        
        
        <!-- show "play" in the options -menu, if there is item played   -->  
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_PLAY" event="key:select" position="0" condition="tvvideoquery:results/[$index]/data_map/tvvideolastwtype &gt; 0"/>
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_SETTINGS" event="custom:vcxnslaunchsettings" position="1"/>       
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_HELP" event="custom:vcxnslaunchhelp" position="2"/>        
    </mm:item> 
    
    <!-- my videos item definition -->
    <mm:item count="1" template="logical_template_6a" id="tvvideomyvideos">
    
        <mm:query namespace="tvvideoquery" service="Service.ContentPublishing" interface="IDataSource">
            <mm:command mode="sync" name="GetList">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="myvideoscontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:query>
        <mm:notify_request service="Service.ContentPublishing" interface="IDataSource">
            <mm:command name="RequestNotification">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="myvideoscontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                  </mm:key>
            </mm:command>
        </mm:notify_request>
        <mm:output alias="mul_title" type="string" value="tvvideosuite_loc:R_VCXNS_MMENU_MY_VIDEOS_TITLE"/>
                        
        <!-- detail if one new video -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue = 1  &amp; 
                                                          tvvideoquery:results/[$index]/data_map/tvvideohasnewvideos = 1">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_ONE_NEW_VIDEO">
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideonamevalue"/>
            </mm:text>
        </mm:output> 
        
        <!-- detail if more than one new videos -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue &gt; 1 &amp; 
                                                          tvvideoquery:results/[$index]/data_map/tvvideohasnewvideos = 1">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_N_NEW_VIDEOS">
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideocountvalue"/>
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideonamevalue"/>
            </mm:text>
        </mm:output>
        
        <!-- detail if no new videos but one video -->
         <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue = 1 &amp;
                                                                tvvideoquery:results/[$index]/data_map/tvvideohasnewvideos = 0">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_ONE_VIDEO"/>
        </mm:output> 
        
        <!-- detail if no new videos but more than one videos -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue &gt; 1 &amp;
                                                                tvvideoquery:results/[$index]/data_map/tvvideohasnewvideos = 0">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_N_VIDEOS">
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideocountvalue"/>
            </mm:text>
        </mm:output> 
        
        <!-- no videos by default-->    
        <mm:output alias="mul_detail" >
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_NO_VIDEOS"/>
        </mm:output>
 
        <!-- My Videos icon is qgn_prop_mp_folder_video.
        AknsConstants.h defines KAknsIIDQgnPropMpFolderVideo skin-ids.
        And videosuite.mbg defines EMbmVideosuiteQgn_prop_mp_folder_video = 16386,
                                   EMbmVideosuiteQgn_prop_mp_folder_video_mask = 16387 -->
        <mm:output alias="mul_icon">
            <mm:image skinid_major="0x101F86E3" skinid_minor="0x18ff" bitmap_id="16386" mask_id="16387" mif_file="videosuite.mif"/>
        </mm:output> 

        <mm:event event="key:select">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>
                        <mm:key name="data">
                            <mm:key name="message" type="string" value="EOpenVideoStorage"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action>
        </mm:event> 
 
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_OPEN" event="key:select" position="0"/>        
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_SETTINGS" event="custom:vcxnslaunchsettings" position="1"/>              
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_HELP" event="custom:vcxnslaunchhelp" position="2"/>        
    </mm:item>
   
    <!-- video feeds item -->
    <mm:item count="1" template="logical_template_6a" id="tvvideovideofeeds">
   
        <mm:query namespace="tvvideoquery" service="Service.ContentPublishing" interface="IDataSource">
            <mm:command mode="sync" name="GetList">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="videofeedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:query>
        <mm:notify_request service="Service.ContentPublishing" interface="IDataSource">
            <mm:command name="RequestNotification">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="videofeedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:notify_request>
      
        <mm:output alias="mul_title" type="string" value="tvvideosuite_loc:R_VCXNS_MMENU_VIDEO_FEEDS_TITLE"/> 
        <!-- detail if one feed -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue = 1">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_ONE_FEED"/>
        </mm:output> 
        <!-- detail if more than one feed -->
        <mm:output alias="mul_detail" type="string" condition="tvvideoquery:results/[$index]/data_map/tvvideocountvalue &gt; 1">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_N_FEEDS">
                <mm:param value="tvvideoquery:results/[$index]/data_map/tvvideocountvalue"/>
            </mm:text>
        </mm:output> 
        <!-- detail no feeds -->
        <mm:output alias="mul_detail">
            <mm:text value="tvvideosuite_loc:R_VCXNS_MMENU_NO_FEEDS"/>
        </mm:output>
        
        <!-- Video Feeds icon is qgn_prop_mp_video_feeds
        AknsConstants.h defines KAknsIIDQgnPropMpVideoFeeds skin-ids.
        And videosuite.mbg defines EMbmVideosuiteQgn_prop_mp_video_feeds = 16388,
                                   EMbmVideosuiteQgn_prop_mp_video_feeds_mask = 16389 -->
        <mm:output alias="mul_icon">
            <mm:image skinid_major="0x101F86E3" skinid_minor="0x23d5" bitmap_id="16388" mask_id="16389" mif_file="videosuite.mif"/>
        </mm:output> 

        <mm:event event="key:select">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>
                        <mm:key name="data">
                               <mm:key name="message" type="string" value="EOpenInternetVideos"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action>                        
        </mm:event>   

        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_OPEN" event="key:select" position="0"/>        
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_SETTINGS" event="custom:vcxnslaunchsettings" position="1"/>         
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_HELP" event="custom:vcxnslaunchhelp" position="2"/>               
    </mm:item> 
      
    <!-- preloaded video item definition -->  
    <mm:item count="tvvideoquery:results/[$count]" template="logical_template_6a" id="tvvideopreloaded"> 
                                      
        <mm:query namespace="tvvideoquery" service="Service.ContentPublishing" interface="IDataSource">
            <mm:command mode="sync" name="GetList">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="preloadedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:query>
        <mm:notify_request service="Service.ContentPublishing" interface="IDataSource">
            <mm:command name="RequestNotification">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="preloadedcontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:notify_request>
                                               
        <mm:output alias="mul_title" type="string" value="tvvideoquery:results/[$index]/data_map/tvvideonamevalue"/>    
        <mm:output alias="mul_icon">
            <mm:image file="tvvideoquery:results/[$index]/data_map/tvvideoiconpath"/> 
        </mm:output> 
        <mm:event event="key:select">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>
                        <mm:key name="data">
                            <mm:key name="message" type="string" value="ELaunchVideoToPlayer"/>
                            <mm:key name="message_data" type="string" value="tvvideoquery:results/[$index]/data_map/tvvideopath"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action>    
        </mm:event>
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_PLAY" event="key:select" position="0"/>
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_SETTINGS" event="custom:vcxnslaunchsettings" position="1"/>        
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_HELP" event="custom:vcxnslaunchhelp" position="2"/>       
    </mm:item>

    <!-- preloaded service group item definition -->
    <mm:item count="tvvideoquery:results/[$count]" template="logical_template_6a" id="tvvideovideoservice">
   
       <mm:query namespace="tvvideoquery" service="Service.ContentPublishing" interface="IDataSource">
            <mm:command mode="sync" name="GetList">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="servicecontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:query>
        <mm:notify_request service="Service.ContentPublishing" interface="IDataSource">
            <mm:command name="RequestNotification">
                <mm:key name="type" type="string" value="cp_data"/>
                <mm:key name="filter">
                    <mm:key name="publisher" type="string" value="tvvideopublisher"/>
                    <mm:key name="content_type" type="string" value="servicecontent"/>
                    <mm:key name="content_id" type="string" value="menucontentid"/> 
                </mm:key>
            </mm:command>
        </mm:notify_request>
         
        <mm:output alias="mul_title" type="string" value="tvvideoquery:results/[$index]/data_map/tvvideonamevalue"/>
        <mm:output alias="mul_icon">
            <mm:image file="tvvideoquery:results/[$index]/data_map/tvvideoiconpath"/> 
        </mm:output> 
        
        <mm:event event="key:select">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                    <mm:key>
                        <mm:key name="plugin_id" type="uid" value="0x20016B9F"/>
                        <mm:key name="data">
                            <mm:key name="message" type="string" value="ELaunchVod"/>
                            <mm:key name="message_data" type="integer" value="tvvideoquery:results/[$index]/data_map/tvvideoidvalue"/>
                        </mm:key>
                    </mm:key>
                </mm:command>
            </mm:action>    
        </mm:event>
        
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_OPEN" event="key:select" position="0"/>        
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_SETTINGS" event="custom:vcxnslaunchsettings" position="1"/>     
        <mm:menuitem name="tvvideosuite_loc:R_VCXNS_MMENU_OPTIONS_HELP" event="custom:vcxnslaunchhelp" position="2"/>       
    </mm:item>

</mm:content>


