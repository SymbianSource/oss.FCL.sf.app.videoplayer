#***********************************************************************************
#
# STIF test script file for testing VOD content client API.
#
#***********************************************************************************

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\testframework\VCXConsts.inc
INCLUDE c:\testframework\VCXErrors.inc
INCLUDE c:\testframework\VCXVodContentApiTest.inc
INCLUDE c:\testframework\VCXServiceNames.inc
INCLUDE c:\testframework\VCXServiceUpdating.inc
[Enddefine]

#------------------------------------------------------------------------------------
#
# Setup services in service database and delete the EPG db.
#
#------------------------------------------------------------------------------------
[Test]
title ET11550 <not a test> Setup interference test services

create VCXTestUtilModule Util
// Copies some known 3G AP to "Internet" destination with "Internet" name for the AP.
Util CopyMethod "Internet" "Internet" "Internet"
Util SetMethodPriority DEFAULT_DEST 3G_AP 0
Util SetUsedDestination DEFAULT_DEST
// Disable connection dialog for "Internet" destination.
Util SetConnectionMethodIntAttribute "Internet" "Internet" 507 2 // 507 is ECmSeamlessnessLevel
Util SetDefaultIapCenrep
delete Util

pause PAUSE
create VCXServiceManagementApiTest ServUtil
ServUtil Create
ServUtil DeleteAllServices SYNC

ServUtil AddHardCodedService 	ASYNC SERVICE_0 	3G_AP 1 0  	// OOPS
ServUtil AddHardCodedService 	ASYNC SERVICE_1 	3G_AP 1 1 		// NokiaVideos
ServUtil AddHardCodedService 	ASYNC SERVICE_10 	3G_AP 1 2 		// NSeries
ServUtil AddHardCodedService 	ASYNC SERVICE_2	 	3G_AP 1 3 		// Rocketboom
ServUtil AddHardCodedService 	ASYNC SERVICE_3	 	3G_AP 1 4 		// YLE Mediasali
ServUtil AddHardCodedService 	ASYNC SERVICE_4	 	3G_AP 1 5 		// Kärppäkanava
ServUtil AddHardCodedService 	ASYNC SERVICE_5	 	3G_AP 1 6 		// Rocketboom5
ServUtil AddHardCodedService 	ASYNC SERVICE_6	 	3G_AP 1 7 		// OOPS6
ServUtil AddHardCodedService 	ASYNC SERVICE_7	 	3G_AP 1 8 		// NokiaVideos7
ServUtil AddHardCodedService 	ASYNC SERVICE_8	 	3G_AP 1 9 		// Rocketboom8

// EXTRA_SERVICE_9 is reserved for cases to change it's address at will

ServUtil AddHardCodedService 	ASYNC SERVICE_9	 	3G_AP 1 10 	// OOPS9
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EAddress 	"http:\/\/193.65.182.78/multiurl.xml"
ServUtil UpdateServiceField 	ASYNC	SERVICE_9		ESetIapList WLAN_AP 1 3G_AP 1
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EName 	EXTRA_SERVICE_1

ServUtil AddHardCodedService 	ASYNC SERVICE_9	 	3G_AP 1 10 	// OOPS9
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EAddress 	"http:\/\/193.65.182.78/mimetype_tests/allmimetypes.xml"
ServUtil UpdateServiceField 	ASYNC	SERVICE_9		ESetIapList WLAN_AP 1 3G_AP 1
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EName 	EXTRA_SERVICE_2

ServUtil AddHardCodedService 	ASYNC SERVICE_9	 	3G_AP 1 10
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EAddress 	"http:\/\/193.65.182.78/preview.xml"
ServUtil UpdateServiceField 	ASYNC	SERVICE_9		ESetIapList WLAN_AP 1 3G_AP 1
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EName 	EXTRA_SERVICE_3

ServUtil AddHardCodedService 	ASYNC SERVICE_9	 	3G_AP 1 10
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EAddress 	"http:\/\/193.65.182.78/ecg_parental_control.xml"
ServUtil UpdateServiceField 	ASYNC	SERVICE_9		ESetIapList WLAN_AP 1 3G_AP 1
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EName 	EXTRA_SERVICE_4

ServUtil AddHardCodedService 	ASYNC SERVICE_9	 	3G_AP 1 10
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EAddress 	"http:\/\/193.65.182.78/dvbtest/xmltv/xmltv_1day.xml"
ServUtil UpdateServiceField 	ASYNC	SERVICE_9		ESetIapList WLAN_AP 1 3G_AP 1
ServUtil UpdateServiceField		ASYNC SERVICE_9 	EName 	EXTRA_SERVICE_5

ServUtil GetServices SYNC 0 250

ServUtil Destroy
delete ServUtil
pause 3000
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11551 UpdateEcg interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Update the service, just in case previous case failed.
#
#------------------------------------------------------------------------------------
[Test]
title ET11552 UpdateEcg SERVICE_0
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11553 GetEcgList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test GetEcgList 1 "" 0 10
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11554 EcgCategoryList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test EcgCategoryList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11555 EcgEcgAllList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test EcgEcgAllList "" 0 5
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11556 CategoryDetails interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test CategoryDetails 1
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11557 ParentCategory interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test ParentCategory 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11558 ContentDetailsList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test ContentDetailsList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11559 SetLastPosition interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start thread cpuload 250 2000
test SetLastPosition 0 0 0
test SetLastPosition 0 0 500
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Update ECG for the service.
#
#------------------------------------------------------------------------------------
[Test]
title ET11560 UpdateEcg SERVICE_10
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11561 GetEcgList search interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test GetEcgList 1 "Amazing Spaces - Adam" 0 10
test GetEcgList 3 "Nokia B" 0 10
test GetEcgList 5 "Wedding" 0 10
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11562 EcgCategoryList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test EcgCategoryList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11563 ContentDetailsList interference CPU thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start thread cpuload 250 2000
test SelectIap DEFAULT_AP
test ContentDetailsList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11564 UpdateEcg interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Update the service, just in case previous case failed.
#
#------------------------------------------------------------------------------------
[Test]
title ET11565 UpdateEcg SERVICE_0
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11566 GetEcgList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test GetEcgList 1 "" 0 10
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11567 EcgCategoryList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test EcgCategoryList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11568 EcgEcgAllList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test EcgEcgAllList "" 0 5
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11569 CategoryDetails interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test CategoryDetails 1
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11570 ParentCategory interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test ParentCategory 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11571 ContentDetailsList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test ContentDetailsList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11572 SetLastPosition interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_0
testinterference interference1 start activeobject cpuload 500 1000
test SetLastPosition 0 0 0
test SetLastPosition 0 0 500
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Update ECG for the service.
#
#------------------------------------------------------------------------------------
[Test]
title ET11573 UpdateEcg SERVICE_10
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11574 GetEcgList search interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test GetEcgList 1 "Amazing Spaces - Adam" 0 10
test GetEcgList 3 "Nokia B" 0 10
test GetEcgList 5 "Wedding" 0 10
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11575 EcgCategoryList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test EcgCategoryList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy CPU load from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11577 ContentDetailsList interference CPU AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test Create SERVICE_10
testinterference interference1 start activeobject cpuload 500 1000
test SelectIap DEFAULT_AP
test ContentDetailsList 0
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy disk writing from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11578 UpdateEcg interference disk write thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start thread filesystemwritec 250 2000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy disk reading from other thread.
#
#------------------------------------------------------------------------------------
[Test]
title ET11579 UpdateEcg interference disk read thread
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start thread filesystemreadc 250 2000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy disk writing from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11580 UpdateEcg interference disk write AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start activeobject filesystemwritec 250 2000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test under heavy disk reading from Active-Object.
#
#------------------------------------------------------------------------------------
[Test]
title ET11581 UpdateEcg interference disk read AO
create VCXTestUtilModule Util
Util CreateMobilecrashWatcher
pause PAUSE
create VCXVodContentApiTest test
test EnableThumbnails
test DeleteEpgDb
test Create SERVICE_0
testinterference interference1 start activeobject filesystemreadc 250 2000
test SelectIap DEFAULT_AP
test UpdateEcg
waittestclass test
testinterference interference1 stop
test Destroy
delete test
Util CheckMobilecrashes
delete Util
[Endtest]
