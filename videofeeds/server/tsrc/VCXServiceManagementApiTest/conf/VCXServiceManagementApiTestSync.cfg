#***********************************************************************************
#
# STIF test script file for testing service management client API.
#
#***********************************************************************************

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\testframework\VCXConsts.inc
INCLUDE c:\testframework\VCXServiceManagementApiTest.inc
INCLUDE c:\testframework\VCXServiceUpdating.inc
INCLUDE c:\testframework\VCXServiceNames.inc
INCLUDE c:\testframework\VCXErrors.inc
[Enddefine]

#------------------------------------------------------------------------------------
#
# Test adding a service.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08002 Setup Add valid hardcoded service 0 SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08002
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest DeleteAllServices SYNC
IptvTest AddHardCodedService SYNC SERVICE_0 2 1 0
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08002
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that updating a service fields works.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08003 Update service fields SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08003
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest UpdateServiceField SYNC SERVICE_0 EFlags ESelected EReadOnly EMainService EConnectionApproved EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_0 EName "Updated Service Name"
IptvTest UpdateServiceField SYNC "Updated Service Name" EName SERVICE_0
IptvTest UpdateServiceField SYNC SERVICE_0 EAddress "http:\/\/www.UpdatedServiceaddress.com"
IptvTest UpdateServiceField SYNC SERVICE_0 EIconPath "c:\\UpdatedIconPath"
IptvTest UpdateServiceField SYNC SERVICE_0 EEpgPluginUid 12345
IptvTest UpdateServiceField SYNC SERVICE_0 EVodPluginUid 23456
IptvTest UpdateServiceField SYNC SERVICE_0 EIptvPluginUid 34567
IptvTest UpdateServiceField SYNC SERVICE_0 EServiceType EVodCast
IptvTest UpdateServiceField SYNC SERVICE_0 ESetIapList 3
IptvTest UpdateServiceField SYNC SERVICE_0 EUserName "Updated USER Name"
IptvTest UpdateServiceField SYNC SERVICE_0 EPassword "Updated PASSWORD"
IptvTest UpdateServiceField SYNC SERVICE_0 EDesc "Updated Service description"
IptvTest UpdateServiceField SYNC SERVICE_0 EFlags ESelected EReadOnly EMainService EConnectionApproved EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_0 EApplicationUid 12
IptvTest UpdateServiceField SYNC SERVICE_0 EDisplayOrder 111
IptvTest UpdateServiceField SYNC SERVICE_0 EProviderId "UPDPROVID"
IptvTest UpdateServiceField SYNC SERVICE_0 EAccountManagementUrl "http:\/\/updatedaccountmanagmenturl.com"
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08003
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Add few valid hardcoded services for later use.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08005 Add valid hardcoded services SYNC setup
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08005
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest AddHardCodedService SYNC SERVICE_1 2 1 1
IptvTest AddHardCodedService SYNC SERVICE_2 2 1 2
IptvTest AddHardCodedService SYNC SERVICE_3 2 1 3
IptvTest AddHardCodedService SYNC SERVICE_4 2 1 4
IptvTest AddHardCodedService SYNC SERVICE_0 10 1 5
IptvTest AddHardCodedService SYNC SERVICE_1 10 1 6
IptvTest AddHardCodedService SYNC SERVICE_2 10 1 7
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08005
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that updating service works.
#
#------------------------------------------------------------------------------------
[Test]
title ET08006 Update valid service SYNC
create VCXTestUtilModule Util
print a
Util IptvLogCaseStart ET08006
print b
pause PAUSE
print c
create VCXServiceManagementApiTest IptvTest
print d
IptvTest Create
IptvTest UpdateService SYNC SERVICE_0 SERVICE_1
IptvTest UpdateService SYNC SERVICE_1 SERVICE_2
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08006
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that updating service with same data functions correctly.
#
#------------------------------------------------------------------------------------
[Test]
title ET08008 Update same valid service SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08008
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest UpdateService SYNC SERVICE_2 SERVICE_2
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08008
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that getting services by index works.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08010 Get services by index SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08010
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest GetServices SYNC 0 5000
IptvTest GetServices SYNC 0 2
IptvTest GetServices SYNC 1 1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08010
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that deleting a service works.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08014 Delete service SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08014
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest DeleteService SYNC SERVICE_1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08014
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test SetUsedIap method with all available iaps.
#
#------------------------------------------------------------------------------------
[Test]
title ET08016 SetUsedIap TestAllIaps SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08016
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest SetUsedIap SERVICE_2 0 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 1 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 2 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 3 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 4 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 5 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 6 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 7 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 8 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 9 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 10 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 11 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 12 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 13 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 14 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 15 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 16 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 17 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 18 TEST_IF_IAP_EXISTS
IptvTest SetUsedIap SERVICE_2 19 TEST_IF_IAP_EXISTS
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08016
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that adding service with 15 iaps works. Maximum iap limit in CIptvIapList is 10 but it can be overridden.
#
#------------------------------------------------------------------------------------
[Test]
title ET08017 Add service with 15 iaps SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08017
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
allownextresult KERRARGUMENT
allownextresult KERRGENERAL
IptvTest AddHardCodedService SYNC SERVICE_15IAPS 2 1 -1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08017
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test deleting all the services.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08018 Delete all services SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08018
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest DeleteAllServices SYNC
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08018
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Add services to be used in later cases.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08019 Add valid services 2 SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08019
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest AddHardCodedService SYNC SERVICE_0 3 1 0
IptvTest AddHardCodedService SYNC SERVICE_1 8 1 1
IptvTest AddHardCodedService SYNC SERVICE_2 3 1 2
IptvTest AddHardCodedService SYNC SERVICE_3 3 1 3
IptvTest AddHardCodedService SYNC SERVICE_4 3 1 4
IptvTest AddHardCodedService SYNC SERVICE_5 3 1 5
IptvTest AddHardCodedService SYNC SERVICE_6 3 1 6
IptvTest AddHardCodedService SYNC SERVICE_7 3 1 7
IptvTest AddHardCodedService SYNC SERVICE_8 3 1 8
IptvTest AddHardCodedService SYNC SERVICE_9 3 1 9
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08019
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that getting services by filter works.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08020 Get filtered services SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08020
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest UpdateServiceField SYNC SERVICE_0 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_1 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_3 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_4 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_5 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_6 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_7 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_8 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_9 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_0 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_1 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_2 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_3 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_4 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_5 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_6 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_7 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_8 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_9 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_1 EFlags EReadOnly EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EReadOnly EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_4 EFlags EReadOnly EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_6 EFlags EReadOnly EReadOnlyIaps
IptvTest GetServicesFiltered SYNC 6 EDisplayOrderAscending ESearchSelectedServices
IptvTest UpdateServiceField SYNC SERVICE_1 EFlags EMainService
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EMainService EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_4 EFlags EMainService
IptvTest UpdateServiceField SYNC SERVICE_6 EFlags EMainService EConnectionApproved
IptvTest UpdateServiceField SYNC SERVICE_8 EFlags EMainService
IptvTest GetServicesFiltered SYNC 5 EDisplayOrderAscending ESearchMainServices
IptvTest GetServicesFiltered SYNC 5 EDisplayOrderAscending ESearchSubServices
IptvTest GetServicesFiltered SYNC 10 EDisplayOrderAscending ESearchNoFlags
IptvTest UpdateServiceField SYNC SERVICE_0 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_1 EServiceType ELiveTv
IptvTest UpdateServiceField SYNC SERVICE_2 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_3 EServiceType ELiveTv
IptvTest UpdateServiceField SYNC SERVICE_4 EServiceType ELiveTv
IptvTest UpdateServiceField SYNC SERVICE_5 EServiceType ELiveTv
IptvTest UpdateServiceField SYNC SERVICE_6 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_7 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_8 EServiceType ELiveTv
IptvTest UpdateServiceField SYNC SERVICE_9 EServiceType EVod
IptvTest GetServicesFiltered SYNC 5 EDisplayOrderAscending ESearchVod
IptvTest GetServicesFiltered SYNC 5 EDisplayOrderAscending ESearchLiveTv
IptvTest UpdateServiceField SYNC SERVICE_0 EServiceType EOther
IptvTest UpdateServiceField SYNC SERVICE_3 EServiceType EOther
IptvTest UpdateServiceField SYNC SERVICE_4 EServiceType EOther
IptvTest UpdateServiceField SYNC SERVICE_6 EServiceType EVodCast
IptvTest UpdateServiceField SYNC SERVICE_1 EServiceType EVodCast
IptvTest UpdateServiceField SYNC SERVICE_3 EServiceType EVodCast
IptvTest GetServicesFiltered SYNC 2 EDisplayOrderAscending ESearchOther
IptvTest GetServicesFiltered SYNC 3 EDisplayOrderAscending ESearchVodCast
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08020
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Call GetServicesFiltered with different sort argument.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08062 Get filtered services sorted SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08062
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest GetServicesFiltered SYNC 3 EDateAscending ESearchVodCast
IptvTest GetServicesFiltered SYNC 3 EDateDescending ESearchVodCast
IptvTest GetServicesFiltered SYNC 3 EDisplayOrderAscending ESearchVodCast
IptvTest GetServicesFiltered SYNC 3 EDisplayOrderDescending ESearchVodCast
allownextresult EGeneralError
IptvTest GetServicesFiltered SYNC 3 7 ESearchVodCast
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08062
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that getting services by provider id works.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08021 Get services by provider id SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08021
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest GetServicesByProviderId Provider_ylemediasali
IptvTest GetServicesByProviderId Provider_oops6
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08021
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that SetUsedIap method works.
#
#------------------------------------------------------------------------------------
[Test]
title ET08024 SetUsedIap SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08024
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest SetUsedIap SERVICE_1 0
IptvTest SetUsedIap SERVICE_0 0
IptvTest SetUsedIap SERVICE_4 1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08024
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that GetUsedIap method works.
#
#------------------------------------------------------------------------------------
[Test]
title ET08025 GetUsedIap SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08025
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest SetUsedIap SERVICE_1 3G_AP
IptvTest GetServices SYNC 0 5000
IptvTest GetUsedIap SYNC SERVICE_1 3G_AP
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08025
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that ClearUsedIap method works.
#
#------------------------------------------------------------------------------------
[Test]
title ET08026 ClearUsedIap SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08026
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest SetUsedIap SERVICE_1 1
IptvTest ClearUsedIap
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08026
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test that SetAllIaps method works.
#
#------------------------------------------------------------------------------------
#[Test]
#title ET08027 SetAllIaps SYNC
#create VCXTestUtilModule Util
#Util IptvLogCaseStart ET08027
#pause PAUSE
#create VCXServiceManagementApiTest IptvTest
#IptvTest Create
#IptvTest SetAllIaps SYNC 4 1
#IptvTest Destroy
#delete IptvTest
#Util IptvLogCaseEnd ET08027
#delete Util
#[Endtest]

#------------------------------------------------------------------------------------
#
# Test that setting and getting connection permissions work.
#
#------------------------------------------------------------------------------------
[Test]
title ET08028 Set connection permission SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08028
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest IsConnectionAllowed 3G_AP PERMISSION_CONFIRM
IptvTest SetConnectionAllowed 3G_AP 1
IptvTest IsConnectionAllowed 3G_AP PERMISSION_ALLOWED
IptvTest SetConnectionAllowed 3G_AP 0
IptvTest IsConnectionAllowed 3G_AP PERMISSION_NOT_ALLOWED
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08028
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test sending two add service requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08029 Repeat add service SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08029
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest AddHardCodedService SYNC SERVICE_0 2 1 -1
IptvTest AddHardCodedService SYNC SERVICE_1 2 1 -1
IptvTest AddHardCodedService SYNC SERVICE_2 2 1 -1
IptvTest AddHardCodedService SYNC SERVICE_3 2 1 -1
IptvTest RepeatNextRequest 2
IptvTest AddHardCodedService SYNC SERVICE_4 2 1 -1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08029
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test sending two update service requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08030 Repeat update service request SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08030
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest RepeatNextRequest 2
IptvTest UpdateServiceField SYNC SERVICE_0 EUserName "Updated User Name"
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08030
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test sending two get services requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08031 Repeat get services by index SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08031
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest RepeatNextRequest 2
IptvTest GetServices SYNC 0 5000
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08031
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Repeat SetUsedIap request to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08033 Repeat SetUsedIap SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08033
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest UpdateServiceField SYNC SERVICE_0 ESetIapList WLAN_AP 2 3G_AP 0
IptvTest RepeatNextRequest 2
IptvTest SetUsedIap SERVICE_0 3G_AP
IptvTest RepeatNextRequest 2
IptvTest SetUsedIap SERVICE_0 WLAN_AP
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08033
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Repeat getting services by filter request to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08035 Repeat get filtered services SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08035
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest UpdateServiceField SYNC SERVICE_0 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_1 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EConnectionApproved ESelected
IptvTest UpdateServiceField SYNC SERVICE_0 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_1 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_2 EServiceType EVod
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EReadOnly EReadOnlyIaps
IptvTest UpdateServiceField SYNC SERVICE_0 EFlags EMainService
IptvTest UpdateServiceField SYNC SERVICE_2 EFlags EMainService EReadOnlyIaps
IptvTest RepeatNextRequest 2
IptvTest GetServicesFiltered SYNC 7 EDisplayOrderAscending ESearchSelectedServices
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08035
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test repeating getServicesByProviderIid requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08036 Repeat get services by provider id SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08036
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest RepeatNextRequest 2
IptvTest GetServicesByProviderId Provider1
IptvTest GetServicesByProviderId Provider2
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08036
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test repeating ClearUsedIap request to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08037 Repeat ClearUsedIap SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08037
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest SetUsedIap SERVICE_1 1
IptvTest RepeatNextRequest 2
IptvTest ClearUsedIap
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08037
delete Util
[Endtest]


#------------------------------------------------------------------------------------
#
# Test repeating the requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08039 Repeat set connection permission and IsConnectionAllowed requests SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08039
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest AddHardCodedService SYNC SERVICE_1 2 1
IptvTest RepeatNextRequest 2
IptvTest IsConnectionAllowed 3G_AP PERMISSION_CONFIRM
IptvTest RepeatNextRequest 2
IptvTest SetConnectionAllowed 3G_AP 1
IptvTest RepeatNextRequest 1
IptvTest IsConnectionAllowed 3G_AP PERMISSION_ALLOWED
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08039
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test sending two delete service requests to the server.
#
#------------------------------------------------------------------------------------
[Test]
title ET08032 Repeat delete service SYNC
create VCXTestUtilModule Util
Util IptvLogCaseStart ET08032
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest AddHardCodedService SYNC SERVICE_1 2 1
IptvTest AddHardCodedService SYNC SERVICE_1 2 1
IptvTest RepeatNextRequest 2
IptvTest DeleteService SYNC SERVICE_1
IptvTest Destroy
delete IptvTest
Util IptvLogCaseEnd ET08032
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Verify that server is shutdown when it has no active clients.
#
#------------------------------------------------------------------------------------
[Test]
title ET08040 Verify server is shutdown SYNC
create VCXServiceManagementApiTest IptvTest
IptvTest Create
IptvTest GetServices SYNC 0 5000
pause 10000
pause 10000
IptvTest Destroy
delete IptvTest
pause 10000
create VCXServiceManagementApiTest IptvTest
IptvTest VerifyServerIsShutdown
delete IptvTest
[Endtest]

#------------------------------------------------------------------------------------
#
# Test setting service url with too long url.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET08041 Too long service URL
pause PAUSE
create VCXServiceManagementApiTest SMTest
SMTest Create
SMTest AddHardCodedService 	SYNC SERVICE_9	 	3G_AP 1 10 	// OOPS9
allownextresult -4 // too long url, not enough memory,
SMTest UpdateServiceField	SYNC SERVICE_9 	EAddress 	EAddress_2kLongUrl
SMTest Destroy
delete SMTest
[Endtest]

#------------------------------------------------------------------------------------
#
# Send shutdown request to the server.
#
# This fails because it's not supported.
#
#------------------------------------------------------------------------------------
[Test]
title ET08042 Repeat get filtered services SYNC
pause PAUSE
create VCXServiceManagementApiTest IptvTest
IptvTest Create
allownextresult 2
IptvTest ShutdownServer SYNC
IptvTest Destroy
delete IptvTest
[Endtest]
