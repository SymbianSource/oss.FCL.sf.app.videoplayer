#-----------------------------------------------------------------------------------
#
# STIF test script file for testing VCXMyVideosCollectionPluginTest.dll
#
# Tests functionality for category video lists.
#
#-----------------------------------------------------------------------------------

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\TestFramework\VCXMVCollectionPluginTest.inc
INCLUDE c:\TestFramework\VCXDrives.inc
INCLUDE c:\TestFramework\VCXConsts.inc
INCLUDE c:\TestFramework\VCXErrors.inc
[Enddefine]

#************************************************************************************
# Sub Cleanup
# Removes all videos from the phone. Collection is opened.
#************************************************************************************
[Sub Cleanup]
print cleanup start
create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV RemoveAllMedia
delete VCXMV

print wait 3min
pause 180000
print cleanup end
[EndSub]

#************************************************************************************
# Sub SetupVideos
#  Creates 5 videos with defined origin. List will be:
#
# a.mp4
# b.mp4
# c.mp4
# d.mp4
# e.mp4
#
# 2nd and 4th videos have new flag set.
#************************************************************************************
[Sub SetupVideos]

callsub Cleanup

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetSortingOrder EVcxMyVideosSortingName

VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Create some video objects.
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "a.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "b.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "c.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "d.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "e.mp4"

pause 10000

VCXMV GetAllMediaFullDetails

VCXMV SetAutomaticRefresh 0

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin ORIGIN
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 1
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin ORIGIN
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 2
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin ORIGIN
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 3
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin ORIGIN
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin ORIGIN
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

delete VCXMV
[EndSub]

#------------------------------------------------------------------------------------
#
#  Does configuration for cases in this script.
#  Creates 'Internet' IAP into 'Internet' destination and sets connection as authorized.
#  Sets preferred memory to first used drive and sorting order to none.
#  Removes all video files from the device.
#
#------------------------------------------------------------------------------------
[Test]
title ET30000 <not a test> Setup

create VCXTestUtilModule Util
// Copies some known 3G AP to "Internet" destination with "Internet" name for the AP.
Util CopyMethod "Internet" "Internet" "Internet"
// Disable connection dialog for "Internet" destination.
Util SetConnectionMethodIntAttribute "Internet" "Internet" 507 2 // 507 is ECmSeamlessnessLevel
delete Util

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetPreferredMemory E_DRIVE
VCXMV SetSortingOrder EVcxMyVideosSortingNone

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV RemoveAllMedia

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'All videos' category when it's empty.
#
#------------------------------------------------------------------------------------
[Test]
title ET30002 All videos - empty
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Downloads' category when it's empty.
#
#------------------------------------------------------------------------------------
[Test]
title ET30003 Downloads - empty
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosDownloads
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'TV Recordings' category when it's empty.
#
#------------------------------------------------------------------------------------
[Test]
title ET30004 TV recordings - empty
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosTvRecordings
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Captured videos' category when it's empty.
#
#------------------------------------------------------------------------------------
[Test]
title ET30005 Captured videos - empty
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosCapturedVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Other videos' category when it's empty.
#
#------------------------------------------------------------------------------------
[Test]
title ET30006 Other videos - empty
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosOther
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Creates five video files, one for every origin. This case is needed by following cases.
#
#------------------------------------------------------------------------------------
[Test]
title ET30007 Setup all origins

callsub Cleanup

// TESTCASE START

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetSortingOrder EVcxMyVideosSortingName

VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Create some video objects.
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "a.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "b.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "c.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "d.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "e.mp4"
pause 1000

VCXMV SetAutomaticRefresh 0

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginOther"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginOther
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginCamera"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 2
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginDownloaded"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginSideloaded"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginSideLoaded
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 4
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginRecording"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginTvRecording
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV SetAutomaticRefresh 1

VCXMV GetAllMediaFullDetails

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'All videos' category when device has videos with different origins.
#
#------------------------------------------------------------------------------------
[Test]
title ET30008 All videos - all origins
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 5

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Downloads' category when device has videos with different origins.
#
#------------------------------------------------------------------------------------
[Test]
title ET30010 Downloads - all origins
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosDownloads
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "OriginDownloaded"

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'TV recordings' category when device has videos with different origins.
#
#------------------------------------------------------------------------------------
[Test]
title ET30011 TV recordings - all origins
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosTvRecordings
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "OriginRecording"

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Captured videos' category when device has videos with different origins.
#
#------------------------------------------------------------------------------------
[Test]
title ET30012 Captured videos - all origins
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosCapturedVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "OriginCamera"

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests opening 'Other videos' category when device has videos with different origins.
#
#------------------------------------------------------------------------------------
[Test]
title ET30013 Other videos - all origins
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosOther
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 2
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "OriginOther"
VCXMV CheckMediaDetail ANY_DRIVE 1 EVcxTestMapping_KMPXMediaGeneralTitle "OriginSideloaded"

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Creates two videos for each different origin, one with new flag and one without.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30051 Setup all origins

callsub Cleanup

// TESTCASE START

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetSortingOrder EVcxMyVideosSortingName

VCXMV SetFileCheck 0

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Create some video objects.
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "a.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "b.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "c.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "d.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "e.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "f.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "g.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "h.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "i.mp4"
pause 1000
VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "j.mp4"
pause 1000

VCXMV GetAllMediaFullDetails

VCXMV SetAutomaticRefresh 0

// Set 5 videos with new video flag

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginOther"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginOther
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginCamera"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 2
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginDownloaded"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginSideloaded"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginSideLoaded
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 4
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginRecording"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginTvRecording
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDateCurrent
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Set next 5 videos with no flags

VCXMV CreateCopyOfMedia ANY_DRIVE 5
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginOther2"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginOther
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 6
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginCamera2"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 7
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginDownloaded2"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginSideloaded2"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginSideLoaded
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 9
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "OriginRecording2"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginTvRecording
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV SetAutomaticRefresh 1

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetAllMediaFullDetails

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CoolDown

delete VCXMV

[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' has correct details when there's videos with different origins.
#
# Preconditions: Case ET30051 run succesfully.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30046 All videos - category details
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 10
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "OriginRecording"

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Downloads' has correct details when there's videos with different origins.
#
# Preconditions: Case ET30051 run succesfully.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30047 Downloads - category details
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "OriginDownloaded"

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'TV recorgins' has correct details when there's videos with different origins.
#
# Preconditions: Case ET30051 run succesfully.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30048 TV recordings - category details
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosTvRecordings EVcxTestMapping_KMPXMediaGeneralTitle "TV recordings"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosTvRecordings EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosTvRecordings EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosTvRecordings EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "OriginRecording"

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Captured videos' has correct details when there's videos with different origins.
#
# Preconditions: Case ET30051 run succesfully.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30049 Captured videos - category details
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosCapturedVideos EVcxTestMapping_KMPXMediaGeneralTitle "Captured videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosCapturedVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosCapturedVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosCapturedVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "OriginCamera"

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' has correct details when there's videos with different origins.
#
# Preconditions: Case ET30051 run succesfully.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30050 Other videos - category details
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "OriginSideloaded"

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when videos are deleted.
#
#------------------------------------------------------------------------------------
[Test]
title ET30052 Other videos - video is deleted, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 DeleteMedia ANY_DRIVE 4 0

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 DeleteMedia ANY_DRIVE 3 0

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when videos are added by sideloading.
#
#------------------------------------------------------------------------------------
[Test]
title ET30053 Other videos - video is sideloaded, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "1.mp4"
pause 500
VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "2.mp4"
pause 5000
VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "3.mp4"

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 8
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "3"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when videos are moved.
#
#------------------------------------------------------------------------------------
[Test]
title ET30054 Other videos - video is moved, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Move video with no new flag.
VCXMV2 MoveMedia C_DRIVE 4 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCopyOrMoveStarted
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Move video with new flag.
VCXMV2 MoveMedia C_DRIVE 3 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCopyOrMoveStarted
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when videos are copied.
#
#------------------------------------------------------------------------------------
[Test]
title ET30055 Other videos - video is copied, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Copy video with no new flag.
VCXMV2 CopyMedia C_DRIVE 4 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionCategoryChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Copy video with new flag.
VCXMV2 CopyMedia C_DRIVE 1 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionCategoryChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 7
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when videos are removed.
#
#------------------------------------------------------------------------------------
[Test]
title ET30056 Other videos - video is removed, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 RemoveMedia ANY_DRIVE 4 0
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 RemoveMedia ANY_DRIVE 3 0
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when the file of a video deleted.
#
#------------------------------------------------------------------------------------
[Test]
title ET30057 Other videos - video file is deleted, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 DeleteFileOfMedia ANY_DRIVE 4
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 DeleteFileOfMedia ANY_DRIVE 3
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Other videos' details are updated when new flag of a video is modified.
#
#------------------------------------------------------------------------------------
[Test]
title ET30058 Other videos - video new flag is modified, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Set new flag off for a media.
VCXMV2 CreateCopyOfMedia ANY_DRIVE 3
VCXMV2 SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV2 SetMedia 1
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

// Set new flag on for another media.
VCXMV2 CreateCopyOfMedia ANY_DRIVE 4
VCXMV2 SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV2 SetMedia 1
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KMPXMediaGeneralTitle "Other"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosOther EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "e"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Downloads' details are updated when video is downloaded.
#
#------------------------------------------------------------------------------------
[Test]
title ET30059 Downloads - video is downloaded, category details

var ORIGIN EVcxMyVideosOriginDownloaded
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Check category details when download is ongoing.
VCXMV2 Download 3G_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV2 WaitForMessages 5MINUTES KVCXMYVideosTestMessageDlRunning

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest0_6megs"

// Check category details after download is ready.
VCXMV2 WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV2 // Dl complete

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest0_6megs"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'Downloads' details are updated when download is canceled.
#
#------------------------------------------------------------------------------------
[Test]
title ET30060 Downloads - download is canceled, category details

var ORIGIN EVcxMyVideosOriginDownloaded
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Check category details when download is ongoing.
VCXMV2 Download 3G_AP SERVICE_2 20 0 "mediacharger" "Buran_9o"
//VCXMV2 WaitForMessages 5MINUTES KVCXMYVideosTestMessageDlRunning
//waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest20_13megs"

// Check category details after download is canceled.
VCXMV2 CancelDownload SERVICE_2 20 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageDlCanceled
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KMPXMediaGeneralTitle "Downloads"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosDownloads EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is deleted.
#
#------------------------------------------------------------------------------------
[Test]
title ET30061 All videos - video is deleted, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 DeleteMedia ANY_DRIVE 4 0

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 DeleteMedia ANY_DRIVE 3 0

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is added by sideloading.
#
#------------------------------------------------------------------------------------
[Test]
title ET30062 All videos - video is sideloaded, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "1.mp4"
pause 500
VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "2.mp4"
pause 5000
VCXMV2 CreateVideoFile IptvTestVideo3Gp C_DRIVE "3.mp4"

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 8
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "3"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is moved.
#
#------------------------------------------------------------------------------------
[Test]
title ET30063 All videos - video is moved, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Move video with no new flag.
VCXMV2 MoveMedia C_DRIVE 4 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCopyOrMoveStarted
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Move video with new flag.
VCXMV2 MoveMedia C_DRIVE 3 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCopyOrMoveStarted
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is copied.
#
#------------------------------------------------------------------------------------
[Test]
title ET30064 All videos - video is copied, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Copy video with no new flag.
VCXMV2 CopyMedia C_DRIVE 4 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionCategoryChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Copy video with new flag.
VCXMV2 CopyMedia C_DRIVE 1 E_DRIVE 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionCategoryChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 7
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is removed.
#
#------------------------------------------------------------------------------------
[Test]
title ET30065 All videos - video is removed, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 RemoveMedia ANY_DRIVE 4 0
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 RemoveMedia ANY_DRIVE 3 0
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when file of a video is deleted.
#
#------------------------------------------------------------------------------------
[Test]
title ET30066 All videos - video file is deleted, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it doesn't have new flag.
VCXMV2 DeleteFileOfMedia ANY_DRIVE 4
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 4
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Delete last media, it has new flag.
VCXMV2 DeleteFileOfMedia ANY_DRIVE 3
VCXMV2 CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when new flag of a video is modified.
#
#------------------------------------------------------------------------------------
[Test]
title ET30067 All videos - video new flag is modified, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Set new flag off for a media.
VCXMV2 CreateCopyOfMedia ANY_DRIVE 3
VCXMV2 SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 0
VCXMV2 SetMedia 1
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 1
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "b"

// Set new flag on for another media.
VCXMV2 CreateCopyOfMedia ANY_DRIVE 4
VCXMV2 SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew
VCXMV2 SetMedia 1
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "e"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when video is downloaded.
#
#------------------------------------------------------------------------------------
[Test]
title ET30068 All videos - video is downloaded, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Check category details when download is ongoing.
VCXMV2 Download 3G_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV2 WaitForMessages 5MINUTES KVCXMYVideosTestMessageDlRunning

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest0_6megs"

// Check category details after download is ready.
VCXMV2 WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV2 // Dl complete

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest0_6megs"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that category 'All videos' details are updated when download is canceled.
#
#------------------------------------------------------------------------------------
[Test]
title ET30069 All videos - download is canceled, category details

var ORIGIN EVcxMyVideosOriginOther
callsub SetupVideos

// Create client to modify videos.
create VCXMyVideosCollectionPluginTest VCXMV2
VCXMV2 Create
VCXMV2 OpenCollection VCXCollectionMyVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2
VCXMV2 OpenLevel EVcxMyVideosAllVideos
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV2

// And second client to check categories.
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

// Check category details when download is ongoing.
VCXMV2 Download 3G_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV2 WaitForMessages 5MINUTES KVCXMYVideosTestMessageDlRunning

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 6
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 3
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "enginetest0_6megs"

// Check category details after download is canceled.
VCXMV2 CancelDownload SERVICE_2 0 0
VCXMV2 WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageDlCanceled
waittestclass VCXMV2

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KMPXMediaGeneralTitle "All videos"
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryItemCount 5
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemCount 2
VCXMV CheckMediaDetail ANY_DRIVE EVcxMyVideosAllVideos EVcxTestMapping_KVcxMediaMyVideosCategoryNewItemName "d"

print OK!
delete VCXMV
delete VCXMV2
[Endtest]

#------------------------------------------------------------------------------------
#
#  This is a setup case for following cases by downloading and sideloading videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30014 Download and sideload video, setup

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "video0.mp4"

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download 3G_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV Download 3G_AP SERVICE_SMALLVIDEOS 2 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests count of videos for category 'All videos' when device has downloaded and sideloaded videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30015 All videos - downloaded
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 3

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests count of videos for category 'Downloads' when device has downloaded and sideloaded videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30016 Downloads - downloaded
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosDownloads
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 2
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV CheckMediaDetail ANY_DRIVE 1 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests count of videos for category 'TV recordings' when device has downloaded and sideloaded videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30017 TV recordings - downloaded
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosTvRecordings
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests count of videos for category 'Captured videos' when device has downloaded and sideloaded videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30018 Captured videos - downloaded
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosCapturedVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests count of videos for category 'Other videos' when device has downloaded and sideloaded videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30019 Other videos - downloaded
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosOther
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginOther

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request is set to have empty list.
#
#------------------------------------------------------------------------------------
[Test]
title ET30032 GetMediasByMpxId - Empty list when no videos

callsub Cleanup

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 0 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
allownextresult KERRARGUMENT
waittestclass VCXMV

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has invalid IDs.
#
#------------------------------------------------------------------------------------
[Test]
title ET30033 GetMediasByMpxId - Invalid IDs when no videos

callsub Cleanup

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId -1 10
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  This is a setup case for following cases.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30023 Setup, DL 2, sideload 18

callsub Cleanup

// TESTCASE START

// Sideload 48 videos and download 2

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideo3Gp C_DRIVE "video.mp4" 50000 20

VCXMV CoolDown

VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CreateCopyOfMedia ANY_DRIVE 1 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginDownloaded
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

delete VCXMV

// Open all videos

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 20

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when request has IDs of all the videos in the device.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30024 GetMediasByMpxId - All videos
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 0 20
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 20

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has only the ID of first video.
#
#------------------------------------------------------------------------------------
[Test]
title ET30025 GetMediasByMpxId - First only
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 0 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has only the ID of last video.
#
#------------------------------------------------------------------------------------
[Test]
title ET30026 GetMediasByMpxId - Last only
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 19 20
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has few IDs of videos.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30027 GetMediasByMpxId - Few from middle
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 7 13
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 6

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has no IDs.
#
#------------------------------------------------------------------------------------
[Test]
title ET30028 GetMediasByMpxId - Empty list
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId 0 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
allownextresult KERRARGUMENT
waittestclass VCXMV

VCXMV GetMediasByMpxId 0 8
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 8

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has invalid IDs.
#
#------------------------------------------------------------------------------------
[Test]
title ET30029 GetMediasByMpxId - Invalid IDs
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId -1 10
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has duplicate IDs.
#
#------------------------------------------------------------------------------------
[Test]
title ET30030 GetMediasByMpxId - Duplicate IDs
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId -2 5
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 10

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests getting medias by their MPX IDs when the request has every second ID of the videos in device.
#
#------------------------------------------------------------------------------------
[Test]
title ET30031 GetMediasByMpxId - Every second item
create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV GetMediasByMpxId -3 10
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageGotMediasByKMpxId
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 5

VCXMV CloseLevel
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]
