#-----------------------------------------------------------------------------------
#
# STIF test script file for testing VCXMyVideosCollectionPluginTest.dll
#
# Tests functionality for attributes of videos.
#
#-----------------------------------------------------------------------------------

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\TestFramework\VCXMVCollectionPluginTest.inc
INCLUDE c:\TestFramework\VCXDrives.inc
INCLUDE c:\TestFramework\VCXConsts.inc
INCLUDE c:\TestFramework\VCXErrors.inc
[Enddefine]

#************************************************************************************
# Sub Cleanup
# Removes all videos from the phone. Collection is opened.
#************************************************************************************
[Sub Cleanup]
print cleanup start
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV RemoveAllMedia

VCXMV CheckMediaCount ANY_DRIVE 0

print wait 3min
pause 3000
print cleanup end
[EndSub]


#************************************************************************************
# Sub SetupCase
# - open collection
# - open all videos
# - ensure 1 video on E_DRIVE
# - ensure 0 videos on C_DRIVE
# - check media count, should be 1
#************************************************************************************
[Sub SetupCase]
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

pause 10000

VCXMV EnsureDriveForVideos E_DRIVE 1 "video.mp4"
VCXMV EnsureDriveForVideos C_DRIVE 0
VCXMV CheckMediaCount ANY_DRIVE 1
[EndSub]



#------------------------------------------------------------------------------------
#
#  Does configuration for cases in this script.
#  Sets preferred memory to first used drive and sorting order to none.
#  Removes all video files from the device.
#
#------------------------------------------------------------------------------------
[Test]
title ET30400 <not a test> Setup
var CASE ET30400

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetPreferredMemory E_DRIVE
VCXMV SetSortingOrder EVcxMyVideosSortingNone

callsub Cleanup

Util CheckMobilecrashes
pause 1000
delete Util

delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that collection plugin updates video attribute when it's changed by
#  3rd party application.
#
#------------------------------------------------------------------------------------
[Test]
title ET30401 KMPXMediaGeneralTitle modified by 3rd party
var CASE ET30401

// Test case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"
VCXMV OutsideMediaUpdate
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30402 Update - attribute KMPXMediaGeneralTitle
var CASE ET30402

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30403 Update - attribute KMPXMediaGeneralUri
var CASE ET30403

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralUri "f:\video1.mp4"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralUri "f:\video1.mp4"

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralUri "f:\my videos\video1.mp4"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RemoveAllMedia

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30404 Update - attribute KMPXMediaGeneralSize
var CASE ET30404

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 100000
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 100000

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating read-only attribute for a video, attribute should not change.
#  Update is done by passing a full media object to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30405 Update - attribute KMPXMediaGeneralDate
var CASE ET30405

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30406 Update - attribute KMPXMediaGeneralFlags
var CASE ET30406

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 775
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 775

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30407 Update - attribute KMPXMediaGeneralCopyright
var CASE ET30407

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "joonas"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "joonas"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating read-only attribute for a video, attribute should not change.
#  Update is done by passing a full media object to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30408 Update - attribute KMPXMediaGeneralMimeType
var CASE ET30408

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "mimeko"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Read only attribute and it's not saved to MDS
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30409 Update - attribute KVcxMediaMyVideosModifiedDate
var CASE ET30409

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 44000
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 44000

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30410 Update - attribute KVcxMediaMyVideosAgeProfile
var CASE ET30410

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 15
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 15

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30411 Update - attribute KVcxMediaMyVideosAudioLanguage
var CASE ET30411

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "hello"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "hello"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30412 Update - attribute KVcxMediaMyVideosAuthor
var CASE ET30412

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "Matti"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "Matti"

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30413 Update - attribute KVcxMediaMyVideosOrigin
var CASE ET30413

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginOther

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

delete VCXMV

pause 2000

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30414 Update - attribute KVcxMediaMyVideosDuration
var CASE ET30414

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 55 66
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 55 66

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute for a video. Update is done by passing a full media object
#  to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30415 Update - attribute KMPXMediaGeneralLastPlaybackPosition
var CASE ET30415

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 22 23
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 22 23

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating read-only attribute for a video, attribute should not change.
#  Update is done by passing a full media object to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30434 Update - attribute KVcxMediaMyVideosAudioFourCc
var CASE ET30434

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioFourCc 616
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioFourCc 616

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]


#------------------------------------------------------------------------------------
#
#  Tests updating all attributes of a video. Close collection and check the attributes.
#  Update is done by passing a full media object to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30417 Update - All attributes, client closed between
var CASE ET30417

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "mimeko"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

//
// Restart client here and check again
//
delete VCXMV

pause 2000

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
allowerrorcodes KERRNOTSUPPORTED
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
allowerrorcodes KERRNOTSUPPORTED
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
allowerrorcodes KERRNOTSUPPORTED
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

delete VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating all attributes of a video. Close collection and check the attributes.
#  Update is done by passing a full media object to collection.
#
#------------------------------------------------------------------------------------
[Test]
title ET30418 Update - All attributes, client closed between, get full details

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "mimeko"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

//
// Restart client here and check again
//
delete VCXMV

pause 2000

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV GetMediaFullDetails ANY_DRIVE 0

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

delete VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30419 Update - partial update KMPXMediaGeneralTitle
var CASE ET30419

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "TESTING"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30420 Update - partial update KMPXMediaGeneralUri
var CASE ET30420

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.

VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralUri "f:\my videos\video1.mp4"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralUri "f:\my videos\video1.mp4"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV RemoveAllMedia

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30421 Update - partial update KMPXMediaGeneralSize
var CASE ET30421

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.

VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 100000
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 100000

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute. Attribute is read-only and should not change.
#
#------------------------------------------------------------------------------------
[Test]
title ET30422 Update - partial update KMPXMediaGeneralDate
var CASE ET30422

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 50009
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 50009

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30423 Update - partial update KMPXMediaGeneralFlags
var CASE ET30423

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 775
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 775

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30424 Update - partial update KMPXMediaGeneralCopyright
var CASE ET30424

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "joonas"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "joonas"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute. Attribute is read-only and should not change.
#
#------------------------------------------------------------------------------------
[Test]
title ET30425 Update - partial update KMPXMediaGeneralMimeType
var CASE ET30425

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "mimeko"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Read only attribute and it's not saved to MDS
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "video/X-RN-MP4"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30426 Update - partial update KVcxMediaMyVideosModifiedDate
var CASE ET30426

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 44000
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 44000

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30427 Update - partial update KVcxMediaMyVideosAgeProfile
var CASE ET30427

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 15
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 15

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30428 Update - partial update KVcxMediaMyVideosAudioLanguage
var CASE ET30428

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "hello"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "hello"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30429 Update - partial update KVcxMediaMyVideosAuthor
var CASE ET30429

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "Matti"
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "Matti"

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30430 Update - partial update KVcxMediaMyVideosOrigin
var CASE ET30430

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30431 Update - partial update KVcxMediaMyVideosDuration
var CASE ET30431

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 55 66
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 55 66

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute.
#
#------------------------------------------------------------------------------------
[Test]
title ET30432 Update - partial update KMPXMediaGeneralLastPlaybackPosition
var CASE ET30432

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 22 23
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 22 23

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute. Attribute is read-only and should not change.
#
#------------------------------------------------------------------------------------
[Test]
title ET30435 Update - partial update KVcxMediaMyVideosAudioFourCc AC3
var CASE ET30435

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioFourCc 12

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioFourCc KCodeAC3
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioFourCc KCodeAC3

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests updating attribute by partial update, meaning the media object has only
#  the updated attribute. Attribute is read-only and should not change.
#
#------------------------------------------------------------------------------------
[Test]
title ET30436 Update - partial update KVcxMediaMyVideosAudioFourCc EAC3
var CASE ET30436

// Setup case

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

callsub SetupCase

// Setup media attributes, create full copy
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioFourCc 12

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Make empty media item, only one attribute is updated.
VCXMV CreateCopyOfMedia ANY_DRIVE 0 0
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioFourCc KCodeEAC3
VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioFourCc KCodeEAC3

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV CloseLevel
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

print OK!
delete VCXMV
[Endtest]