#-----------------------------------------------------------------------------------
#
# STIF test script file for testing VCXMyVideosCollectionPluginTest.dll
#
# Tests functionality for downloading video files.
#
#-----------------------------------------------------------------------------------

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\TestFramework\VCXMVCollectionPluginTest.inc
INCLUDE c:\TestFramework\VCXDrives.inc
INCLUDE c:\TestFramework\VCXConsts.inc
INCLUDE c:\TestFramework\VCXErrors.inc
[Enddefine]

#************************************************************************************
# Sub Cleanup
# Removes all videos from the phone. Collection is opened.
#************************************************************************************
[Sub Cleanup]
print cleanup start
create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV RemoveAllMedia
delete VCXMV

print pause 3min
pause 180000
print cleanup end
[EndSub]
#************************************************************************************

#------------------------------------------------------------------------------------
#
#  Does configuration for cases in this script.
#  Creates 'Internet' IAP into 'Internet' destination and sets connection as authorized.
#  Sets preferred memory to first used drive and sorting order to none.
#  Removes all video files from the device.
#
#------------------------------------------------------------------------------------
[Test]
title ET30300 <not a test> Setup
var CASE ET30300

create VCXTestUtilModule Util

// Copies some known 3G AP to "Internet" destination with "Internet" name for the AP.
Util SetUsedDestination DEFAULT_DEST
Util CopyMethod "Internet" "Internet" "Internet"
// Disable connection dialog for "Internet" destination.
Util SetConnectionMethodIntAttribute "Internet" "Internet" 507 2 // 507 is ECmSeamlessnessLevel

Util CreateMobilecrashWatcher

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetPreferredMemory E_DRIVE
VCXMV SetSortingOrder EVcxMyVideosSortingNone

// Open collection
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Open category
VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Remove all videos.
VCXMV RemoveAllMedia

// Get the list again and verify videos have been removed.
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0
print OK!

delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests downloading same video two times.
#
#------------------------------------------------------------------------------------
[Test]
title ET30301 2 downloads, same url
var CASE ET30301

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Check that there's no other videos
VCXMV CheckMediaCount ANY_DRIVE 0

VCXMV Download DEFAULT_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV // Dl started

VCXMV Download DEFAULT_AP SERVICE_2 19 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV // Dl started

VCXMV WaitAllDownloads 5
waittestclass VCXMV

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Check videos have been loaded
VCXMV CheckMediaCount ANY_DRIVE 2

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that download goes to paused state when connection is disconnected.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30302 Download, connection disconnects
var CASE ET30302

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetAutoResume 0

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_2 20 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV // Dl started

loop 3
Util WaitForConnectionActivity DEFAULT_AP
allowerrorcodes KERRTIMEDOUT
waittestclass Util
allowerrorcodes KERRNOTFOUND
allowerrorcodes KERRALREADYEXISTS
Util Attach DEFAULT_AP
allowerrorcodes KERRNOTREADY
Util Terminate
endloop

VCXMV CoolDown

delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming download after connection has been disconnected.
#
#------------------------------------------------------------------------------------
[Test]
title ET30303 Download, connection disconnects, resume
var CASE ET30303

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetAutoResume 0

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV // Dl started

loop 3
Util WaitForConnectionActivity DEFAULT_AP
allowerrorcodes KERRTIMEDOUT
waittestclass Util
allowerrorcodes KERRNOTFOUND
allowerrorcodes KERRALREADYEXISTS
Util Attach DEFAULT_AP
allowerrorcodes KERRNOTREADY
Util Terminate
endloop

VCXMV CoolDown

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDownloadState EVcxMyVideosDlStatePaused

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests collection background download functionality, client exits before download is complete.
#
#------------------------------------------------------------------------------------
[Test]
title ET30304 Client deleted before DL completes.
var CASE ET30304

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV // Dl started

print OK!
delete VCXMV

[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling a finished download, operation should do nothing.
#
#------------------------------------------------------------------------------------
[Test]
title ET30305 Cancel finished download
var CASE ET30305

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Downloaded video
VCXMV CheckMediaCount ANY_DRIVE 1

// Cancel download
VCXMV CancelDownload SERVICE_SMALLVIDEOS 0 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete
//allowerrorcodes KERRARGUMENT
waittestclass VCXMV // Dl canceled

VCXMV CoolDown

VCXMV CheckMediaCount ANY_DRIVE 0

delete VCXMV

print OK!
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling download with invalid MPX ID.
#
#------------------------------------------------------------------------------------
[Test]
title ET30306 Cancel download with invalid MPX ID
var CASE ET30306

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Cancel download
VCXMV CancelDownloadById 666 -1 0 // Will use real download id
allowerrorcodes KERRLOCKED
allowerrorcodes KERRARGUMENT
allowerrorcodes KERRCORRUPT
waittestclass VCXMV

VCXMV CoolDown

delete VCXMV

// Check that video doesn't exist.

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Downloaded video
VCXMV CheckMediaCount ANY_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling download with invalid download ID.
#
#------------------------------------------------------------------------------------
[Test]
title ET30311 Cancel download with invalid download ID
var CASE ET30311

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// Test

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 20 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Cancel download
VCXMV CancelDownloadById -1 666 0 // Will use real mpx id
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete
//VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageDlCanceled
allowerrorcodes KERRNOTFOUND
allowerrorcodes KERRCORRUPT
waittestclass VCXMV

VCXMV CoolDown

delete VCXMV

// Check that video doesn't exist

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Downloaded video
VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests downloading video with 1024 characters long url.
#
#------------------------------------------------------------------------------------
[Test]
title ET30307 Download with long url
var CASE ET30307

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP VCXMYVideosTest1kURL 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests downloading video with 2048 characters long url.
#
#------------------------------------------------------------------------------------
[Test]
title ET30329 Download with long url 2
var CASE ET30329

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP VCXMYVideosTest2kURL 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allowerrorcodes KERRARGUMENT
//allowerrorcodes -7376
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with invalid url.
#
#------------------------------------------------------------------------------------
[Test]
title ET30308 Download invalid url
var CASE ET30308

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DisableDownloadCheck

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP "http:\/\/asdfsda" 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult KVCXMYVideosTestMessageDlFailed
allownextresult EObjectNotFound
allownextresult -7376
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with empty url.
#
#------------------------------------------------------------------------------------
[Test]
title ET30309 Download empty url
var CASE ET30309

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DisableDownloadCheck

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP VCXTestZeroUrl 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult KERRARGUMENT
allownextresult KERRABORT
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download when destination folder doesn't exist.
#
#------------------------------------------------------------------------------------
[Test]
title ET30310 Download video, dest folder does not exist
var CASE ET30310

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

Util DeleteFolder "c:\data\videos\"
Util DeleteFolder "e:\my videos\"
Util DeleteFolder "e:\my videos\downloads\"
//"

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with IAP which doesn't work.
#
# Note: Disabled because connection dialog is shown.
#------------------------------------------------------------------------------------
//[Test]
//title ET30312 Download video with bad IAP

//create VCXTestUtilModule Util
//Util CreateMobilecrashWatcher

//callsub Cleanup

// TESTCASE START

//create  VCXMyVideosCollectionPluginTest VCXMV
//VCXMV Create

// Get list of videos
//VCXMV OpenCollection VCXCollectionMyVideos
//VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
//waittestclass VCXMV

//VCXMV SetAutoResume 0

//VCXMV OpenLevel EVcxMyVideosAllVideos
//VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
//waittestclass VCXMV

//VCXMV Download BAD_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
//VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlPaused KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
//allowerrorcodes EConnectionFailed
//waittestclass VCXMV // Dl complete

// Lets resume it with working AP
//VCXMV ResumeDownload DEFAULT_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
//VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
//waittestclass VCXMV

//VCXMV SetAutoResume 1

//VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
//waittestclass VCXMV // Dl complete

//VCXMV CheckMediaCount E_DRIVE 1

//print OK!
//delete VCXMV

//Util CheckMobilecrashes
//pause 1000
//delete Util
//[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with invalid iap, it doesn't exist.
#
#------------------------------------------------------------------------------------
[Test]
title ET30313 Download video with invalid IAP
var CASE ET30313

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV SetAutoResume 0

VCXMV Download VCXTestInvalidIap SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlPaused KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allowerrorcodes KVCXMYVideosTestMessageDlFailed
waittestclass VCXMV // Dl complete

// Lets resume it with working AP
VCXMV ResumeDownload DEFAULT_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 30SECONDS KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download without username and password.
#
#------------------------------------------------------------------------------------
[Test]
title ET30314 Download video wo username nor password
var CASE ET30314

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 1 0
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EHttpAuthenticationFailed
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with invalid username.
#
#------------------------------------------------------------------------------------
[Test]
title ET30315 Download video with invalid username
var CASE ET30315

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 1 0 "xxx" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EHttpAuthenticationFailed
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with invalid password.
#
#------------------------------------------------------------------------------------
[Test]
title ET30316 Download video with invalid password
var CASE ET30316

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 1 0 "mediacharger" "xxx"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EHttpAuthenticationFailed
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Sets default used memory for following cases.
#
#------------------------------------------------------------------------------------
[Test]
title <not a test> Setup default memory

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create
VCXMV SetPreferredMemory E_DRIVE
delete VCXMV
print OK!
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download of video which doesn't exist on the server.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30317 Download 404
var CASE ET30317

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP "http:\/\/193.65.182.78/asdfsdafasasdf.mp3" 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EObjectNotFound
waittestclass VCXMV // Dl complete

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download when the url has address of server which doesn't exist.
#
#------------------------------------------------------------------------------------
[Test]
title ET30318 Download invalid server
var CASE ET30318

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP "http:\/\/111.111.111.111/asdfsdafasasdf.mp3" 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allowerrorcodes EHttpUnhandled
allowerrorcodes -7376
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags EVcxMyVideosVideoNew

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests download with streaming video address.
#
#------------------------------------------------------------------------------------
[Test]
title ET30319 Download stream
var CASE ET30319

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP "rtsp:\/\/193.65.182.100/rtpencoder/WTT_ch02.sdp" 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allowerrorcodes KVCXMYVideosTestErrorDownloadNotFound
allowerrorcodes -7376
waittestclass VCXMV

VCXMV CoolDown

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests pausing of download which is already in paused state.
#
#------------------------------------------------------------------------------------
[Test]
title ET30320 Pause paused download
var CASE ET30320

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV // Command complete

// Pause it
VCXMV PauseDownload SERVICE_2 1 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
waittestclass VCXMV // Dl paused

// Pause again
VCXMV PauseDownload SERVICE_2 1 0
//VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
//waittestclass VCXMV // Dl paused

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests pausing of a download which has been finished, it doesn't exist.
#
#------------------------------------------------------------------------------------
[Test]
title ET30321 Pause finished download ( non existing )
var CASE ET30321

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_SMALLVIDEOS 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV

// Pause it
VCXMV PauseDownload SERVICE_SMALLVIDEOS 0 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming a download which is already running.
#
#------------------------------------------------------------------------------------
[Test]
title ET30323 Resume running download
var CASE ET30323

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming download with different IAP what it was started.
#
#------------------------------------------------------------------------------------
[Test]
title ET30324 Resume with different IAP
var CASE ET30324

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download WLAN_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Pause it
VCXMV PauseDownload SERVICE_2 1 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
waittestclass VCXMV // Dl paused

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming download with no username and password.
#
#------------------------------------------------------------------------------------
[Test]
title ET30325 Resume without username nor password
var CASE ET30325

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Pause it
VCXMV PauseDownload SERVICE_2 1 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
waittestclass VCXMV // Dl paused

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EHttpAuthenticationFailed
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming download with invalid username and password.
#
#------------------------------------------------------------------------------------
[Test]
title ET30326 Resume with invalid username and password
var CASE ET30326

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Pause it
VCXMV PauseDownload SERVICE_2 1 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
waittestclass VCXMV // Dl paused

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0 "xxx" "xxxx"
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allownextresult EHttpAuthenticationFailed
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount ANY_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests resuming download which doesn't exist.
#
#------------------------------------------------------------------------------------
[Test]
title ET30327 Resume non existing download
var CASE ET30327

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV ResumeDownload DEFAULT_AP SERVICE_2 1 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 0

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests two downloads at the same time, the videos have same url.
#
#------------------------------------------------------------------------------------
[Test]
title ET30328 Two downloads same time with same URL
var CASE ET30328

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 0 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

// Start download
VCXMV Download DEFAULT_AP SERVICE_2 19 0 "mediacharger" "Buran_9o"
VCXMV WaitForMessages 5MINUTES KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

VCXMV WaitAllDownloads 4 // wait for 4 minutes
waittestclass VCXMV

VCXMV CheckMediaCount ANY_DRIVE 2

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
# Test resuming download which doesn't support pausing.
#
#------------------------------------------------------------------------------------
[Test]
title ET30330 Ranged download, non pausable file
var CASE ET30330

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START
create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV DownloadUrl DEFAULT_AP "http:\/\/waplabdc.nokia-boston.com/browser/users/drm1.0/CD/CD_kulkurin_iltakalja.dm" 0

// Wait download to start.
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlRunning
waittestclass VCXMV

print Pausing

// Pause it
VCXMV PauseDownloadByUrl "http:\/\/waplabdc.nokia-boston.com/browser/users/drm1.0/CD/CD_kulkurin_iltakalja.dm" 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageDlPaused
allowerrorcodes KERRTIMEDOUT // Might also fail
waittestclass VCXMV // Dl paused

print Resuming

// Pause it
VCXMV ResumeAllDownloads
VCXMV WaitForAnyMessage 5MINUTES KVCXMYVideosTestMessageDlSucceeded KVCXMYVideosTestMessageDlFailed KVCXMYVideosTestMessageDlGeneral
allowerrorcodes KERRTIMEDOUT // Might also fail
waittestclass VCXMV // Dl complete

VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]
