#-----------------------------------------------------------------------------------
#
# STIF test script file for testing VCXMyVideosCollectionPluginTest.dll
#
# Tests functionality for move and copy of video files.
#
#-----------------------------------------------------------------------------------

[StifSettings]
CapsModifier= IptvTestClientApiCapsMod.exe
[EndStifSettings]

[Define]
INCLUDE c:\TestFramework\VCXMVCollectionPluginTest.inc
INCLUDE c:\TestFramework\VCXDrives.inc
INCLUDE c:\TestFramework\VCXConsts.inc
INCLUDE c:\TestFramework\VCXErrors.inc
[Enddefine]

#************************************************************************************
# Sub Cleanup
# Removes all videos from the phone. Collection is opened.
#************************************************************************************
[Sub Cleanup]
print cleanup start
create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV RemoveAllMedia
delete VCXMV

print wait 3sec
pause 3000
print cleanup end
[EndSub]
#************************************************************************************

#************************************************************************************

#------------------------------------------------------------------------------------
#
#  Does configuration for cases in this script.
#  Creates 'Internet' IAP into 'Internet' destination and sets connection as authorized.
#  Sets preferred memory to first used drive and sorting order to none.
#  Removes all video files from the device.
#
#------------------------------------------------------------------------------------
[Test]
title ET30700 <not a test> Setup
var CASE ET30700

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

create VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

VCXMV SetPreferredMemory E_DRIVE
VCXMV SetSortingOrder EVcxMyVideosSortingNone

VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV RemoveAllMedia

VCXMV CheckMediaCount ANY_DRIVE 0
delete VCXMV

Util CheckMobilecrashes
pause 1000
delete Util
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving a video from first to second drive.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30701 Move from 1st to 2nd drive
var CASE ET30701

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

VCXMV MoveMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCopyOrMoveStarted
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that video attributes are kept when moving a video.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30702 Check attributes of moved file
var CASE ET30702

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

// Update attributes
// Sets all possible attributes of video.
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 2
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "d"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

VCXMV MoveMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 1

// Check attributes

VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"
// Size is set to right size of the file after move.
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
// General date is read-only.
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
// Mime type is read-only.
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralMimeType "d"
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10
VCXMV CheckMediaDetail ANY_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosOrigin EVcxMyVideosOriginCapturedWithCamera

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving video to one drive and back.
#
#------------------------------------------------------------------------------------
[Test]
title ET30703 Move back
var CASE ET30703

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

// Move the file

VCXMV MoveMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 1

// File is locked, pause for a while
pause 20000

// Move it back

VCXMV MoveMedia E_DRIVE 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving a video to drive which already has videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30704 Move, drive has already videos
var CASE ET30704

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded videos
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video1.mp4"

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

VCXMV MoveMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 2

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving a video to drive which already has a video with same name.
#
#------------------------------------------------------------------------------------
[Test]
title ET30705 Move when file with same name exists
var CASE ET30705

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded videos
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

// Move the file

VCXMV MoveMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 2

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving a video from second to first drive.
#
#------------------------------------------------------------------------------------
[Test]
title ET30706 Move from 2nd to 1st drive
var CASE ET30706

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

VCXMV MoveMedia E_DRIVE 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 0
VCXMV CheckMediaCount C_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving multiple videos.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30707 Move multiple
var CASE ET30707

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video.mp4" 50000 10

VCXMV CheckMediaCount C_DRIVE 10
VCXMV CheckMediaCount E_DRIVE 0

VCXMV MoveMedias C_DRIVE 0 5 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 5
VCXMV CheckMediaCount E_DRIVE 5

print OK!
delete VCXMV
[Endtest]


#------------------------------------------------------------------------------------
#
#  Tests move video with invalid argument.
#
#------------------------------------------------------------------------------------
[Test]
title ET30710 Move nothing
var CASE ET30710

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video 1 .mp4"

VCXMV MoveMedias E_DRIVE 1 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
allownextresult KERRARGUMENT
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling move operation.
#
#------------------------------------------------------------------------------------
[Test]
title ET30711 Cancel move
var CASE ET30711

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video.mp4" 70000 30

VCXMV CheckMediaCount E_DRIVE 30
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CancelNextOperation
VCXMV MoveMedias E_DRIVE 0 30 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandCanceled
waittestclass VCXMV

VCXMV CoolDown

// Check that all videos have not been moved
VCXMV CheckMinimumMediaCount E_DRIVE 5

VCXMV CheckMediaCount ANY_DRIVE 30

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling when there's video move operation is not ongoing.
#
#------------------------------------------------------------------------------------
[Test]
title ET30713 Cancel move without request
var CASE ET30713

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CancelMove

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests moving a video to same drive where it already is.
#
#------------------------------------------------------------------------------------
[Test]
title ET30712 Move to same drive
var CASE ET30712

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

VCXMV MoveMedia E_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
// already exists
allownextresult -11
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests move operation when media array is not defined for the request.
#
#------------------------------------------------------------------------------------
[Test]
title ET30714 Move no array specified
var CASE ET30714

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video 1 .mp4"

VCXMV MoveMedias E_DRIVE -4 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageMoveResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
allownextresult KERRARGUMENT
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying a video from first to second drive.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30751 Copy from 1st to 2nd drive
var CASE ET30751

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

VCXMV CopyMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged KVCXMYVideosTestMessageCollectionCategoryChanged
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests that video details are kept when copying a video.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30752 Check attributes of copied file
var CASE ET30752

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

pause 10000

// Update attributes
// Sets all possible attributes of video.
VCXMV CreateCopyOfMedia ANY_DRIVE 0

VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralTitle "a"
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralDate 2
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralFlags 3
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralCopyright "c"
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralMimeType "d"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
VCXMV SetMediaDetail EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV SetMediaDetail EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

VCXMV SetMedia 1
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CopyMedia E_DRIVE 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

// Check attributes

VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralTitle "a"
// Size is set by collection after copy.
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralExtSizeInt64 1
// Read-only attribute.
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralDate 3
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralCopyright "c"
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosModifiedDate 4
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAgeProfile 5
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAudioLanguage "e"
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosAuthor "f"
allowerrorcodes KERRCORRUPT
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KVcxMediaMyVideosDuration 7 8
VCXMV CheckMediaDetail E_DRIVE 0 EVcxTestMapping_KMPXMediaGeneralLastPlaybackPosition 9 10

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying a video to same drive where the video was copied from.
#
#------------------------------------------------------------------------------------
[Test]
title ET30753 Copy back
var CASE ET30753

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 0

// Copy the file

VCXMV CopyMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

// Copy it back

VCXMV CopyMedia E_DRIVE 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 2
VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying video to drive which already has videos.
#
#------------------------------------------------------------------------------------
[Test]
title ET30754 Copy, drive has already videos
var CASE ET30754

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video1.mp4"

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

VCXMV CopyMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 2

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying video to drive which already has video with same name.
#
#------------------------------------------------------------------------------------
[Test]
title ET30755 Copy when file with same name exists
var CASE ET30755

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 C_DRIVE "video0.mp4"

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 1

// Copy the file

VCXMV CopyMedia C_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete KVCXMYVideosTestMessageCollectionItemChanged
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 1
VCXMV CheckMediaCount E_DRIVE 2

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying video from second to first drive.
#
#------------------------------------------------------------------------------------
[Test]
title ET30756 Copy from 2nd to 1st drive
var CASE ET30756

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CopyMedia E_DRIVE 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying multiple videos.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30757 Copy multiple
var CASE ET30757

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video.mp4" 50000 10

VCXMV CheckMediaCount E_DRIVE 10
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CopyMedias E_DRIVE 0 5 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 10
VCXMV CheckMediaCount C_DRIVE 5

print OK!
delete VCXMV
[Endtest]


#------------------------------------------------------------------------------------
#
#  Tests copying with invalid argument.
#
#------------------------------------------------------------------------------------
[Test]
title ET30760 Copy nothing
var CASE ET30760

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video 1 .mp4"

VCXMV CopyMedias E_DRIVE 1 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
allownextresult KERRARGUMENT
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests canceling a copy operation.
#
# CaseClass: core
#------------------------------------------------------------------------------------
[Test]
title ET30761 Cancel copy
var CASE ET30761

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video.mp4" 70000 30

VCXMV CheckMediaCount E_DRIVE 30
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CancelNextOperation
VCXMV CopyMedias E_DRIVE 0 30 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCommandCanceled
waittestclass VCXMV

VCXMV CoolDown

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

// Check that at least few videos have been copied
VCXMV CheckMaximumMediaCount C_DRIVE 25
VCXMV CheckMediaCount E_DRIVE 30

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests cancel copy request when there's no copy ongoing.
#
#------------------------------------------------------------------------------------
[Test]
title ET30762 Cancel Copy without request
var CASE ET30762

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CancelCopy

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount C_DRIVE 0
VCXMV CheckMediaCount E_DRIVE 0

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copying a video to same drive.
#
#------------------------------------------------------------------------------------
[Test]
title ET30763 Copy to same drive
var CASE ET30763

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

// Create sideloaded video
VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video0.mp4"

VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

VCXMV CopyMedia E_DRIVE 0 E_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
// already exists
allownextresult -11
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1

print OK!
delete VCXMV
[Endtest]

#------------------------------------------------------------------------------------
#
#  Tests copy operation when the request has no array defined.
#
#------------------------------------------------------------------------------------
[Test]
title ET30764 Copy no array specified
var CASE ET30764

create VCXTestUtilModule Util
Util CreateMobilecrashWatcher

callsub Cleanup

// TESTCASE START

create  VCXMyVideosCollectionPluginTest VCXMV
VCXMV Create

// Get list of videos
VCXMV OpenCollection VCXCollectionMyVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV OpenLevel EVcxMyVideosAllVideos
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened KVCXMYVideosTestMessageListComplete
waittestclass VCXMV

VCXMV CreateVideoFile IptvTestVideoMpeg4 E_DRIVE "video 1 .mp4"

VCXMV CopyMedias E_DRIVE 1 0 C_DRIVE 0
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCopyResp KVCXMYVideosTestMessageCopyOrMoveStarted KVCXMYVideosTestMessageCommandComplete
allownextresult KERRARGUMENT
waittestclass VCXMV

// Get list of all videos
VCXMV RefreshContents
VCXMV WaitForMessages 1MINUTE KVCXMYVideosTestMessageCollectionOpened
waittestclass VCXMV

VCXMV CheckMediaCount E_DRIVE 1
VCXMV CheckMediaCount C_DRIVE 0

print OK!
delete VCXMV
[Endtest]
